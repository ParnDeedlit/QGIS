<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="696px" preserveAspectRatio="none" style="width:744px;height:696px;background:#FFFFFF;" version="1.1" viewBox="0 0 744 696" width="744px" zoomAndPan="magnify"><defs/><g><rect fill="none" height="146.6641" style="stroke:#000000;stroke-width:1.5;" width="728.5" x="10" y="98.2969"/><rect fill="none" height="162.7969" style="stroke:#000000;stroke-width:1.5;" width="728.5" x="10" y="258.9609"/><rect fill="none" height="162.7969" style="stroke:#000000;stroke-width:1.5;" width="728.5" x="10" y="435.7578"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="40" x2="40" y1="81.2969" y2="615.5547"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="181" x2="181" y1="81.2969" y2="615.5547"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="401" x2="401" y1="81.2969" y2="615.5547"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="698.5" x2="698.5" y1="81.2969" y2="615.5547"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="34" x="20" y="77.9951">QGIS</text><ellipse cx="40" cy="13.5" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M40,21.5 L40,48.5 M27,29.5 L53,29.5 M40,48.5 L27,63.5 M40,48.5 L53,63.5 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="34" x="20" y="627.5498">QGIS</text><ellipse cx="40" cy="639.3516" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M40,647.3516 L40,674.3516 M27,655.3516 L53,655.3516 M40,674.3516 L27,689.3516 M40,674.3516 L53,689.3516 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><path d="M76,55 L286,55 C291,55 291,68.1484 291,68.1484 C291,68.1484 291,81.2969 286,81.2969 L76,81.2969 C71,81.2969 71,68.1484 71,68.1484 C71,68.1484 71,55 76,55 " fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;"/><path d="M286,55 C281,55 281,68.1484 281,68.1484 C281,81.2969 286,81.2969 286,81.2969 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="200" x="76" y="72.9951">QgsPostgresConnPoolGroup</text><path d="M76,614.5547 L286,614.5547 C291,614.5547 291,627.7031 291,627.7031 C291,627.7031 291,640.8516 286,640.8516 L76,640.8516 C71,640.8516 71,627.7031 71,627.7031 C71,627.7031 71,614.5547 76,614.5547 " fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;"/><path d="M286,614.5547 C281,614.5547 281,627.7031 281,627.7031 C281,640.8516 286,640.8516 286,640.8516 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="200" x="76" y="632.5498">QgsPostgresConnPoolGroup</text><path d="M306,55 L497,55 C502,55 502,68.1484 502,68.1484 C502,68.1484 502,81.2969 497,81.2969 L306,81.2969 C301,81.2969 301,68.1484 301,68.1484 C301,68.1484 301,55 306,55 " fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;"/><path d="M497,55 C492,55 492,68.1484 492,68.1484 C492,81.2969 497,81.2969 497,81.2969 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="181" x="306" y="72.9951">QgsConnectionPoolGroup</text><path d="M306,614.5547 L497,614.5547 C502,614.5547 502,627.7031 502,627.7031 C502,627.7031 502,640.8516 497,640.8516 L306,640.8516 C301,640.8516 301,627.7031 301,627.7031 C301,627.7031 301,614.5547 306,614.5547 " fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;"/><path d="M497,614.5547 C492,614.5547 492,627.7031 492,627.7031 C492,640.8516 497,640.8516 497,640.8516 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="181" x="306" y="632.5498">QgsConnectionPoolGroup</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54" x="668.5" y="77.9951">PostGIS</text><path d="M680.5,29 C680.5,19 698.5,19 698.5,19 C698.5,19 716.5,19 716.5,29 L716.5,55 C716.5,65 698.5,65 698.5,65 C698.5,65 680.5,65 680.5,55 L680.5,29 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M680.5,29 C680.5,39 698.5,39 698.5,39 C698.5,39 716.5,39 716.5,29 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54" x="668.5" y="627.5498">PostGIS</text><path d="M680.5,640.8516 C680.5,630.8516 698.5,630.8516 698.5,630.8516 C698.5,630.8516 716.5,630.8516 716.5,640.8516 L716.5,666.8516 C716.5,676.8516 698.5,676.8516 698.5,676.8516 C698.5,676.8516 680.5,676.8516 680.5,666.8516 L680.5,640.8516 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M680.5,640.8516 C680.5,650.8516 698.5,650.8516 698.5,650.8516 C698.5,650.8516 716.5,650.8516 716.5,640.8516 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><path d="M10,98.2969 L93,98.2969 L93,105.4297 L83,115.4297 L10,115.4297 L10,98.2969 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="146.6641" style="stroke:#000000;stroke-width:1.5;" width="728.5" x="10" y="98.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="38" x="25" y="111.3638">初始化</text><polygon fill="#181818" points="686.5,132.5625,696.5,136.5625,686.5,140.5625,690.5,136.5625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="40" x2="692.5" y1="136.5625" y2="136.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="47" y="131.4966">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="60" y="131.4966">数据连接池初始化</text><polygon fill="#181818" points="169,161.6953,179,165.6953,169,169.6953,173,165.6953" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="40" x2="175" y1="165.6953" y2="165.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="47" y="160.6294">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="60" y="160.6294">数据连接池初始化</text><polygon fill="#181818" points="389.5,190.8281,399.5,194.8281,389.5,198.8281,393.5,194.8281" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="181" x2="395.5" y1="194.8281" y2="194.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="188" y="189.7622">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160" x="201" y="189.7622">构造函数调用基类initTimer</text><line style="stroke:#181818;stroke-width:1.0;" x1="401.5" x2="443.5" y1="223.9609" y2="223.9609"/><line style="stroke:#181818;stroke-width:1.0;" x1="443.5" x2="443.5" y1="223.9609" y2="236.9609"/><line style="stroke:#181818;stroke-width:1.0;" x1="402.5" x2="443.5" y1="236.9609" y2="236.9609"/><polygon fill="#181818" points="412.5,232.9609,402.5,236.9609,412.5,240.9609,408.5,236.9609" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="408.5" y="218.895">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="421.5" y="218.895">声明一个60秒的定时器</text><path d="M10,258.9609 L105,258.9609 L105,266.0938 L95,276.0938 L10,276.0938 L10,258.9609 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="162.7969" style="stroke:#000000;stroke-width:1.5;" width="728.5" x="10" y="258.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="50" x="25" y="272.0278">成功申请</text><polygon fill="#181818" points="686.5,293.2266,696.5,297.2266,686.5,301.2266,690.5,297.2266" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="40" x2="692.5" y1="297.2266" y2="297.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="47" y="292.1606">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138" x="60" y="292.1606">申请数据库连接acquire</text><polygon fill="#181818" points="169,322.3594,179,326.3594,169,330.3594,173,326.3594" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="40" x2="175" y1="326.3594" y2="326.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="47" y="321.2935">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47" x="60" y="321.2935">acquire</text><polygon fill="#181818" points="389.5,351.4922,399.5,355.4922,389.5,359.4922,393.5,355.4922" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="181" x2="395.5" y1="355.4922" y2="355.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="188" y="350.4263">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47" x="201" y="350.4263">acquire</text><polygon fill="#181818" points="686.5,380.625,696.5,384.625,686.5,388.625,690.5,384.625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="401.5" x2="692.5" y1="384.625" y2="384.625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="408.5" y="379.5591">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="244" x="421.5" y="379.5591">qgsConnectionPool_ConnectionCreate</text><polygon fill="#181818" points="412.5,409.7578,402.5,413.7578,412.5,417.7578,408.5,413.7578" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="406.5" x2="697.5" y1="413.7578" y2="413.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="418.5" y="408.6919">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182" x="431.5" y="408.6919">acquire中acquiredConns + 1</text><path d="M10,435.7578 L106,435.7578 L106,442.8906 L96,452.8906 L10,452.8906 L10,435.7578 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="162.7969" style="stroke:#000000;stroke-width:1.5;" width="728.5" x="10" y="435.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="51" x="25" y="448.8247">成功释放</text><polygon fill="#181818" points="686.5,470.0234,696.5,474.0234,686.5,478.0234,690.5,474.0234" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="40" x2="692.5" y1="474.0234" y2="474.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="47" y="468.9575">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139" x="69" y="468.9575">释放数据库连接release</text><polygon fill="#181818" points="169,499.1563,179,503.1563,169,507.1563,173,503.1563" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="40" x2="175" y1="503.1563" y2="503.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="47" y="498.0903">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47" x="69" y="498.0903">release</text><polygon fill="#181818" points="389.5,528.2891,399.5,532.2891,389.5,536.2891,393.5,532.2891" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="181" x2="395.5" y1="532.2891" y2="532.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="188" y="527.2231">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47" x="210" y="527.2231">release</text><polygon fill="#181818" points="686.5,557.4219,696.5,561.4219,686.5,565.4219,690.5,561.4219" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="401.5" x2="692.5" y1="561.4219" y2="561.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="408.5" y="556.356">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="251" x="430.5" y="556.356">qgsConnectionPool_ConnectionDestroy</text><polygon fill="#181818" points="412.5,586.5547,402.5,590.5547,412.5,594.5547,408.5,590.5547" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="406.5" x2="697.5" y1="590.5547" y2="590.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="418.5" y="585.4888">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176" x="440.5" y="585.4888">acquire中acquiredConns - 1</text><!--MD5=[315c0378f03fa078c4d56796331ba50a]
@startuml
actor QGIS as QGIS
queue QgsPostgresConnPoolGroup as QgsPostgresConnPoolGroup
queue QgsConnectionPoolGroup  as QgsConnectionPoolGroup
database PostGIS as PostGIS
autonumber
group 初始化
QGIS - -> PostGIS: 数据连接池初始化
QGIS -> QgsPostgresConnPoolGroup: 数据连接池初始化
QgsPostgresConnPoolGroup -> QgsConnectionPoolGroup:构造函数调用基类initTimer
QgsConnectionPoolGroup -> QgsConnectionPoolGroup:声明一个60秒的定时器
end
group 成功申请
QGIS - -> PostGIS: 申请数据库连接acquire
QGIS -> QgsPostgresConnPoolGroup: acquire
QgsPostgresConnPoolGroup -> QgsConnectionPoolGroup:acquire
QgsConnectionPoolGroup -> PostGIS:qgsConnectionPool_ConnectionCreate
PostGIS -> QgsConnectionPoolGroup:acquire中acquiredConns + 1
end
group 成功释放
QGIS - -> PostGIS: 释放数据库连接release
QGIS -> QgsPostgresConnPoolGroup: release
QgsPostgresConnPoolGroup -> QgsConnectionPoolGroup:release
QgsConnectionPoolGroup -> PostGIS:qgsConnectionPool_ConnectionDestroy
PostGIS -> QgsConnectionPoolGroup:acquire中acquiredConns - 1
end

@enduml

PlantUML version 1.2022.8(Sun Sep 25 17:00:33 CST 2022)
(MIT source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>